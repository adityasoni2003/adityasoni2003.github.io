---
import BaseLayout from "../layouts/Layout.astro";
import Hero from "../react/Hero";
import FeaturedBlogs from "../components/FeaturedBlogs.astro";
import FeaturedProjects from "../components/FeaturedProjects.astro";

import type { Blog } from "../lib/types";
import type { Project } from "../lib/types";
import SkillsSection from "../components/SkillsSection.astro";
import SkillsBanner from "../react/SkillsBanner";
import AboutMe from "../components/AboutMe.astro";
import { sanity } from "../lib/sanity";
import imageUrlBuilder from "@sanity/image-url";

const builder = imageUrlBuilder(sanity);
const urlFor = (source: any) => builder.image(source).url();

const blogs = await sanity.fetch(`
  *[_type == "blog" && featured == true]
  | order(date desc) {
    title,
    description,
    url,
    topic,
    date,
    thumbnail
  }
`);

const featuredBlogs = blogs.map((blog: Blog) => ({
  ...blog,
  thumbnail: blog.thumbnail ? urlFor(blog.thumbnail) : ""
}));

/* ---------------- PROJECTS ---------------- */

const projects = await sanity.fetch(`
  *[_type == "project" && featured == true]
  | order(date desc) {
    title,
    description,
    liveUrl,
    githubUrl,
    date,
    featured,
    thumbnail
  }
`);

const featuredProjects: Project[] = projects.map((project: any) => ({
  ...project,
  thumbnail: project.thumbnail ? urlFor(project.thumbnail) : ""
}));


export const skills: string[] = [
  "React.js",
  "Next.js",
  "Astro",
  "TypeScript",
  "JavaScript",

  "MongoDB",
  "PostgreSQL",
  "Redis",
  "MySQL",
  "Firebase",

  "Generative AI",
  "Tool-calling Agents",

  "Node.js",
  "Express.js",
  "RESTful APIs",
  "Mongoose",
  "GraphQL APIs",
  "Service Layer Architecture",
  "Go",

  "Redux",
  "TanStack Query",
  "React Hook Form",
  "Zod",

  "Code Splitting",
  "Bundle Analysis",
  "Caching",
  "Progressive Loading",

  "Tailwind CSS",
  "ANT Design",
  "SCSS",
  "Styled Components",

  "Docker",
  "Linux",
  "CI/CD",

  "Socket.io",
  "WebRTC",
  "WebSockets",
];

---

<BaseLayout title="Aditya Soni - Software Engineer">
  <Hero client:load/>
  <AboutMe/>
  <SkillsBanner skills={skills} client:load/>
  <SkillsSection/>
  <FeaturedProjects projects={featuredProjects} />
  <FeaturedBlogs blogs={featuredBlogs}/>
</BaseLayout>
